// Generated by CoffeeScript 1.6.3
(function() {
  var _this = this;

  angular.module('angularDcjsApp').controller('MainController', [
    '$scope', 'Debug', 'dataAPI', function($scope, Debug, dataAPI) {
      $scope.measures = [];
      $scope.dimensions = [];
      $scope.log = function(value) {
        return Debug.input(value);
      };
      $scope.getLog = function() {
        return Debug.output();
      };
      $scope.retrieveData = function() {
        d3.csv('sampledata.csv', function(response) {
          return $scope.$apply(function() {
            return $scope.rows = crossfilter(response);
          });
        });
        /*dataAPI.getData().then((response)->
          $scope.rows = response.data
          $scope.identifyHeaders(response.data)
          return
        )
        */

      };
      $scope.identifyHeaders = function(data) {
        $scope.getMeasures(data);
        return $scope.getDimensions(data);
      };
      $scope.getDimensions = function(data) {
        var items;
        items = [];
        if (data) {
          angular.forEach(data[0], function(value) {
            var input;
            input = value.match(/DIMENSION:(.*)/);
            if (input) {
              return items.push(input[1]);
            }
          });
          if (items.length > 0) {
            $scope.measures = items;
            return $scope.log({
              name: 'Dimensions',
              'items': items
            });
          }
        }
      };
      $scope.getMeasures = function(data) {
        var items;
        items = [];
        if (data) {
          angular.forEach(data[0], function(value) {
            var input;
            input = value.match(/MEASURE:(.*)/);
            if (input) {
              return items.push(input[1]);
            }
          });
          if (items.length > 0) {
            $scope.dimensions = items;
            return $scope.log({
              name: 'Measures',
              'items': items
            });
          }
        }
      };
      return $scope.retrieveData();
    }
  ]);

}).call(this);

/*
//@ sourceMappingURL=main.map
*/
